{"version":3,"sources":["player-utils.js"],"names":["softmax","arr","map","value","index","Math","exp","y","reduce","a","b","issueDifference","candidate","total","issues","size","getTopFiveIssues","keys","issue","has","abs","get","determineVoteShare","election","node","differenceTotals","totalDifference","element","percentageRawDifference","percentageDifference","turnout","population","tanh","min","forEach","votes","floor","campaignOnNode","amount","set","shiftAndClip","newAmount","connections","base","shift"],"mappings":"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","file":"build.js","sourcesContent":["// lifted softmax function\r\nfunction softmax(arr) {\r\n    return arr.map(function(value,index) {\r\n      return Math.exp(value) / arr.map( function(y /*value*/){ return Math.exp(y) } ).reduce( function(a,b){ return a+b })\r\n    })\r\n}\r\n\r\nfunction issueDifference(candidate){\r\n    let total = 0;\r\n    let issues = this.issues.size > 5 ? this.getTopFiveIssues : this.issues;\r\n\r\n    for(let issue of this.issues.keys()){\r\n        if(this.issues.has(issue) && candidate.issues.has(issue)){\r\n            total += Math.abs(this.issues.get(issue) - candidate.issues.get(issue));\r\n        }\r\n    }\r\n    return total;\r\n}\r\n\r\nfunction determineVoteShare(election, node){\r\n\r\n    let differenceTotals = election.map(issueDifference, node);\r\n\r\n    let totalDifference = differenceTotals.reduce((total,element)=>{\r\n        return total + element\r\n    },0);\r\n\r\n    let percentageRawDifference = differenceTotals.reduce((total,element)=>{\r\n        return total +  element/totalDifference\r\n    },0);\r\n\r\n    let percentageDifference = differenceTotals.map((element)=>{\r\n        return totalDifference/element\r\n    });\r\n\r\n    // caculate voter turnout based on min difference\r\n    // using tanh for a sigmoid function, cause why not, i just need to make an idelogical difference into a proportion of 1\r\n    let turnout = node.population * (1 - Math.tanh(Math.min(...differenceTotals)));\r\n\r\n    // console.log(`Turnout for ${node.name} was ${Math.floor((1 - Math.tanh(Math.min(...differenceTotals))) * 100)}%`);\r\n    // distribute voter turnout by share\r\n    softmax(percentageDifference).forEach((candidate, index)=>{\r\n        election[index].votes += Math.floor(turnout * candidate);\r\n        //console.log(`candidate ${election[index].name} received ${Math.floor(turnout * candidate)} (${Math.floor(100 * candidate)}%) votes from ${node.name}`)\r\n    });\r\n\r\n    return election;\r\n};\r\n\r\n\r\n\r\n// simple campaign function where changes propogate through the network\r\n// influence willbounce around with diminishing returns until its less than 0.001\r\nfunction campaignOnNode(issue, amount){\r\n\r\n    return function(node){\r\n        node.issues.set(issue, shiftAndClip(node.issues.get(issue), amount));\r\n\r\n        // console.log(`campaigning on node ${node.name} by ${amount}. Now ${node.issues.get(issue)}`);\r\n\r\n        let newAmount = amount / 2;\r\n\r\n        if(newAmount > 0.1){\r\n            node.connections.forEach(campaignOnNode(issue, newAmount));\r\n        }\r\n    }\r\n\r\n}\r\n\r\n// change node issue vlaues but clips values between 0 and 1\r\nfunction shiftAndClip(base, shift){\r\n    base += shift;\r\n\r\n    if(base > 1){\r\n        base = 1;\r\n    }\r\n\r\n    if( base < 0){\r\n        base = 0;\r\n    }\r\n\r\n    return base;\r\n}\r\n\r\nexport { shiftAndClip, campaignOnNode,  determineVoteShare, softmax}\r\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZ3JhcGhVdGlscyIsImFuYWx5dGljc1Rvb2xzIiwicGxheWVyVXRpbHMiLCJlbGVjdGlvblJhdyIsIm5hbWUiLCJpc3N1ZXMiLCJmb28iLCJiYXIiLCJzY3ViIiwidm90ZXMiLCJncmFwaCIsImNyZWF0ZUdyYXBoIiwibGl2ZU5ldHdvcmsiLCJjcmVhdGVMaXZlTmV0d29yayIsIm5vZGVzIiwiZGlzdHJpY3RzIiwiY3JlYXRlRGlzdHJpY3RzIiwiY29uc29sZSIsImxvZyIsInBvcHVsYXRpb24xIiwicG9wdWxhdGlvbjIiLCJwb3B1bGF0aW9uMyIsInBvcHVsYXRpb240IiwicG9wdWxhdGlvbjUiLCJwb3B1bGF0aW9uNiIsImNhbmRpZGF0ZXMxIiwibWFwIiwibGl2ZUVsZWN0aW9uIiwiY2FuZGlkYXRlczIiLCJjYW5kaWRhdGVzMyIsImNhbmRpZGF0ZXM0IiwiY2FuZGlkYXRlczUiLCJjYW5kaWRhdGVzNiIsImVsZWN0aW9ucyIsImVsZWN0aW9uVG90YWxzMSIsImVsZW1lbnQiLCJwb3B1bGF0aW9uIiwicmVkdWNlIiwiZGV0ZXJtaW5lVm90ZVNoYXJlIiwicHVzaCIsImhpc3RvZ3JhbSIsImhpc3RvZ3JhbUhhc2htYXBUb0FycmF5Iiwic29ydE5vZGVzIiwiY3JlYXRlUmFuZ2UiLCJzb3J0IiwiYSIsImIiLCJrZXkiLCJlbGVjdGlvblRvdGFscyIsInZhbHVlcyIsInNlbGVjdGVkTm9kZTEiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJsZW5ndGgiLCJjYW1wYWlnbk9uTm9kZSIsImVsZWN0aW9uVG90YWxzNCIsImoiLCJmb3JFYWNoIiwiaW5mbHVlbmNlTm9kZXMiLCJhcHBseUluZmx1ZW5jZSIsImVsZWN0aW9uVG90YWxzMiIsInRvcDI1IiwiY29ubmVjdGlvbnMiLCJzbGljZSIsImVsZWN0aW9uVG90YWxzMyIsInNrdWJFeHRyZWFtaXN0cyIsIm5vZGUiLCJlbGVjdGlvblRvdGFsczUiLCJza3ViU3VwcG9ydGVycyIsImZpbHRlciIsImdldCIsImVsZWN0aW9uVG90YWxzNiIsIm52IiwiYWRkR3JhcGgiLCJjaGFydCIsIm1vZGVscyIsImRpc2NyZXRlQmFyQ2hhcnQiLCJ4IiwiZCIsInkiLCJzdGFnZ2VyTGFiZWxzIiwidG9vbHRpcHMiLCJzaG93VmFsdWVzIiwiaGlzdG9ncmFtQ2hhcnQiLCJoaXN0b3JpY2FsQmFyQ2hhcnQiLCJ2YWx1ZSIsImZvcmNlWCIsImdyYXBocyIsImQzIiwic2VsZWN0Iiwic2VsZWN0QWxsIiwiZGF0YSIsImVudGVyIiwiYXBwZW5kIiwiZGF0dW0iLCJ0ZXh0IiwiYXR0ciIsImNhbGwiLCJ1dGlscyIsIndpbmRvd1Jlc2l6ZSIsInVwZGF0ZSJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7SUFBWUEsVTs7QUFDWjs7SUFBWUMsYzs7QUFDWjs7SUFBWUMsVzs7OztBQUVaLElBQUlDLGNBQWMsQ0FDZDtBQUNJQyxVQUFLLFVBRFQ7QUFFSUMsWUFBTztBQUNIQyxhQUFJLEVBREQ7QUFFSEMsYUFBSSxFQUZEO0FBR0hDLGNBQUs7QUFIRixLQUZYO0FBT0lDLFdBQU07QUFQVixDQURjLEVBVWQ7QUFDSUwsVUFBSyxTQURUO0FBRUlDLFlBQU87QUFDSEMsYUFBSSxDQUREO0FBRUhDLGFBQUksQ0FGRDtBQUdIQyxjQUFLO0FBSEYsS0FGWDtBQU9JQyxXQUFNO0FBUFYsQ0FWYyxFQW1CZDtBQUNJTCxVQUFLLGtCQURUO0FBRUlDLFlBQU87QUFDSEMsYUFBSSxDQUREO0FBRUhDLGFBQUksQ0FGRDtBQUdIQyxjQUFLO0FBSEYsS0FGWDtBQU9JQyxXQUFNO0FBUFYsQ0FuQmMsRUE0QmQ7QUFDSUwsVUFBSyxZQURUO0FBRUlDLFlBQU87QUFDSEMsYUFBSSxHQUREO0FBRUhDLGFBQUksR0FGRDtBQUdIQyxjQUFLO0FBSEYsS0FGWDtBQU9JQyxXQUFNO0FBUFYsQ0E1QmMsRUFxQ2Q7QUFDSUwsVUFBSyxZQURUO0FBRUlDLFlBQU87QUFDSEMsYUFBSSxHQUREO0FBRUhDLGFBQUksR0FGRDtBQUdIQyxjQUFLO0FB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bnRlbnQiOlsiaW1wb3J0ICogYXMgZ3JhcGhVdGlscyBmcm9tICcuL3NyYy9ncmFwaC11dGlscy9ncmFwaC11dGlscy5qcycgO1xyXG5pbXBvcnQgKiBhcyBhbmFseXRpY3NUb29scyBmcm9tICcuL3NyYy9hbmFseXRpY3MtdG9vbHMvYW5hbHl0aWNzLXRvb2xzLmpzJztcclxuaW1wb3J0ICogYXMgcGxheWVyVXRpbHMgZnJvbSAnLi9zcmMvcGxheWVyLXV0aWxzL3BsYXllci11dGlscy5qcyc7XHJcblxyXG5sZXQgZWxlY3Rpb25SYXcgPSBbXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTpcIm1vZGVyYXRlXCIsXHJcbiAgICAgICAgaXNzdWVzOntcclxuICAgICAgICAgICAgZm9vOi41LFxyXG4gICAgICAgICAgICBiYXI6LjUsXHJcbiAgICAgICAgICAgIHNjdWI6LjVcclxuICAgICAgICB9LFxyXG4gICAgICAgIHZvdGVzOjBcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgICAgbmFtZTpcImV4dHJlbWVcIixcclxuICAgICAgICBpc3N1ZXM6e1xyXG4gICAgICAgICAgICBmb286MSxcclxuICAgICAgICAgICAgYmFyOjEsXHJcbiAgICAgICAgICAgIHNjdWI6MVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdm90ZXM6MFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgICBuYW1lOlwiZXh0cmVtZSBvdGhlcndheVwiLFxyXG4gICAgICAgIGlzc3Vlczp7XHJcbiAgICAgICAgICAgIGZvbzowLFxyXG4gICAgICAgICAgICBiYXI6MCxcclxuICAgICAgICAgICAgc2N1YjowXHJcbiAgICAgICAgfSxcclxuICAgICAgICB2b3RlczowXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6XCJtb2RlcmF0ZSAyXCIsXHJcbiAgICAgICAgaXNzdWVzOntcclxuICAgICAgICAgICAgZm9vOjAuNSxcclxuICAgICAgICAgICAgYmFyOjAuNSxcclxuICAgICAgICAgICAgc2N1YjowLjU1XHJcbiAgICAgICAgfSxcclxuICAgICAgICB2b3RlczowXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6XCJMZWFucyBza3ViXCIsXHJcbiAgICAgICAgaXNzdWVzOntcclxuICAgICAgICAgICAgZm9vOjAuNSxcclxuICAgICAgICAgICAgYmFyOjAuNSxcclxuICAgICAgICAgICAgc2N1YjowLjg1XHJcbiAgICAgICAgfSxcclxuICAgICAgICB2b3RlczowXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICAgIG5hbWU6XCJwcm8tU2N1YlwiLFxyXG4gICAgICAgIGlzc3Vlczp7XHJcbiAgICAgICAgICAgIGZvbzowLjUsXHJcbiAgICAgICAgICAgIGJhcjowLjUsXHJcbiAgICAgICAgICAgIHNjdWI6MVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdm90ZXM6MFxyXG4gICAgfVxyXG5dO1xyXG5cclxubGV0IGdyYXBoID0gZ3JhcGhVdGlscy5jcmVhdGVHcmFwaCgxMDAwKTtcclxubGV0IGxpdmVOZXR3b3JrID0gZ3JhcGhVdGlscy5jcmVhdGVMaXZlTmV0d29yayhncmFwaC5ub2Rlcyk7XHJcbmxldCBkaXN0cmljdHMgPSBncmFwaFV0aWxzLmNyZWF0ZURpc3RyaWN0cygxMCxsaXZlTmV0d29yayk7XHJcbmNvbnNvbGUubG9nKGxpdmVOZXR3b3JrKTtcclxuXHJcblxyXG5cclxubGV0IHBvcHVsYXRpb24xID0gZ3JhcGhVdGlscy5jcmVhdGVMaXZlTmV0d29yayhncmFwaC5ub2Rlcyk7XHJcbmxldCBwb3B1bGF0aW9uMiA9IGdyYXBoVXRpbHMuY3JlYXRlTGl2ZU5ldHdvcmsoZ3JhcGgubm9kZXMpO1xyXG5sZXQgcG9wdWxhdGlvbjMgPSBncmFwaFV0aWxzLmNyZWF0ZUxpdmVOZXR3b3JrKGdyYXBoLm5vZGVzKTtcclxubGV0IHBvcHVsYXRpb240ID0gZ3JhcGhVdGlscy5jcmVhdGVMaXZlTmV0d29yayhncmFwaC5ub2Rlcyk7XHJcbmxldCBwb3B1bGF0aW9uNSA9IGdyYXBoVXRpbHMuY3JlYXRlTGl2ZU5ldHdvcmsoZ3JhcGgubm9kZXMpO1xyXG5sZXQgcG9wdWxhdGlvbjYgPSBncmFwaFV0aWxzLmNyZWF0ZUxpdmVOZXR3b3JrKGdyYXBoLm5vZGVzKTtcclxuXHJcbmxldCBjYW5kaWRhdGVzMSA9IGVsZWN0aW9uUmF3Lm1hcChncmFwaFV0aWxzLmxpdmVFbGVjdGlvbik7XHJcbmxldCBjYW5kaWRhdGVzMiA9IGVsZWN0aW9uUmF3Lm1hcChncmFwaFV0aWxzLmxpdmVFbGVjdGlvbik7XHJcbmxldCBjYW5kaWRhdGVzMyA9IGVsZWN0aW9uUmF3Lm1hcChncmFwaFV0aWxzLmxpdmVFbGVjdGlvbik7XHJcbmxldCBjYW5kaWRhdGVzNCA9IGVsZWN0aW9uUmF3Lm1hcChncmFwaFV0aWxzLmxpdmVFbGVjdGlvbik7XHJcbmxldCBjYW5kaWRhdGVzNSA9IGVsZWN0aW9uUmF3Lm1hcChncmFwaFV0aWxzLmxpdmVFbGVjdGlvbik7XHJcbmxldCBjYW5kaWRhdGVzNiA9IGVsZWN0aW9uUmF3Lm1hcChncmFwaFV0aWxzLmxpdmVFbGVjdGlvbik7XHJcblxyXG4vLyBjb2xsZWN0IGVsZWN0aW9ucyBmb3IgZ3JhcGhpbmdcclxubGV0IGVsZWN0aW9ucyA9IFtdO1xyXG5cclxuY29uc29sZS5sb2coXCIlYyBSYXcgcG9wdWxhdGlvbjogZWxlY3Rpb24gd2l0aCBiYXJlIG5ldHdvcmtcIiwgJ2JhY2tncm91bmQ6ICMyMjI7IGNvbG9yOiAjYmFkYTU1Jyk7XHJcbmxldCBlbGVjdGlvblRvdGFsczEgPSBwb3B1bGF0aW9uMS5tYXAoZWxlbWVudCA9PiB7ZWxlbWVudC5wb3B1bGF0aW9uID0gMTAwMDsgcmV0dXJuIGVsZW1lbnQ7fSkucmVkdWNlKHBsYXllclV0aWxzLmRldGVybWluZVZvdGVTaGFyZSxjYW5kaWRhdGVzMSk7XHJcblxyXG5jb25zb2xlLmxvZyhlbGVjdGlvblRvdGFsczEpO1xyXG5lbGVjdGlvbnMucHVzaCh7XHJcbiAgICBoaXN0b2dyYW06YW5hbHl0aWNzVG9vbHMuaGlzdG9ncmFtSGFzaG1hcFRvQXJyYXkocG9wdWxhdGlvbjEucmVkdWNlKGFuYWx5dGljc1Rvb2xzLnNvcnROb2RlcyxhbmFseXRpY3NUb29scy5jcmVhdGVSYW5nZSgxMDApKSkuc29ydCgoYSxiKT0+IGEua2V5PmIua2V5ICksXHJcbiAgICBlbGVjdGlvblRvdGFsczpbe1xyXG4gICAgICAgIGtleTpcIlJhdyBwb3B1bGF0aW9uOiBlbGVjdGlvbiB3aXRoIGJhcmUgbmV0d29ya1wiLFxyXG4gICAgICAgIHZhbHVlczplbGVjdGlvblRvdGFsczFcclxuICAgIH1dXHJcbn0pO1xyXG5cclxuY29uc29sZS5sb2coXCIlYyBSYXcgcG9wdWxhdGlvbjogZWxlY3Rpb24gd2l0aCBiYXJlIG5ldHdvcmsgYWZ0ZXIgY2FtcGFpZ25pbmcgb24gYSBzaW5nbGUgbm9kZVwiLCAnYmFja2dyb3VuZDogIzIyMjsgY29sb3I6ICNiYWRhNTUnKTtcclxuXHJcbmxldCBzZWxlY3RlZE5vZGUxID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcG9wdWxhdGlvbjQubGVuZ3RoKTtcclxuXHJcbnBsYXllclV0aWxzLmNhbXBhaWduT25Ob2RlKFwic2N1YlwiLCAxKShwb3B1bGF0aW9uNFtzZWxlY3RlZE5vZGUxXSk7XHJcblxyXG5sZXQgZWxlY3Rpb25Ub3RhbHM0ID0gcG9wdWxhdGlvbjQubWFwKGVsZW1lbnQgPT4ge2VsZW1lbnQucG9wdWxhdGlvbiA9IDEwMDA7IHJldHVybiBlbGVtZW50O30pLnJlZHVjZShwbGF5ZXJVdGlscy5kZXRlcm1pbmVWb3RlU2hhcmUsY2FuZGlkYXRlczQpO1xyXG5cclxuY29uc29sZS5sb2coZWxlY3Rpb25Ub3RhbHM0KTtcclxuZWxlY3Rpb25zLnB1c2goe1xyXG4gICAgaGlzdG9ncmFtOmFuYWx5dGljc1Rvb2xzLmhpc3RvZ3JhbUhhc2htYXBUb0FycmF5KHBvcHVsYXRpb240LnJlZHVjZShhbmFseXRpY3NUb29scy5zb3J0Tm9kZXMsYW5hbHl0aWNzVG9vbHMuY3JlYXRlUmFuZ2UoMTAwKSkpLnNvcnQoKGEsYik9PiBhLmtleT5iLmtleSApLFxyXG4gICAgZWxlY3Rpb25Ub3RhbHM6W3tcclxuICAgICAgICBrZXk6XCJSYXcgcG9wdWxhdGlvbjogZWxlY3Rpb24gd2l0aCBiYXJlIG5ldHdvcmsgYWZ0ZXIgY2FtcGFpZ25pbmcgb24gYSBzaW5nbGUgbm9kZVwiLFxyXG4gICAgICAgIHZhbHVlczplbGVjdGlvblRvdGFsczRcclxuICAgIH1dXHJcbn0pO1xyXG5cclxuY29uc29sZS5sb2coXCIlYyBhZnRlciAxMCB3ZWVrcyBvZiBub2RlIGluZmx1ZW5jaW5nIG9uZSBhbm90aGVyXCIsICdiYWNrZ3JvdW5kOiAjMjIyOyBjb2xvcjogI2JhZGE1NScpO1xyXG5cclxuZm9yKGxldCBqID0gMDsgaiA8IDEwOyBqKyspe1xyXG4gICAgcG9wdWxhdGlvbjIuZm9yRWFjaChncmFwaFV0aWxzLmluZmx1ZW5jZU5vZGVzKTtcclxuICAgIHBvcHVsYXRpb24yLmZvckVhY2goZ3JhcGhVdGlscy5hcHBseUluZmx1ZW5jZSk7XHJcbn1cclxuXHJcbmxldCBlbGVjdGlvblRvdGFsczIgPSBwb3B1bGF0aW9uMi5tYXAoZWxlbWVudCA9PiB7ZWxlbWVudC5wb3B1bGF0aW9uID0gMTAwMDsgcmV0dXJuIGVsZW1lbnQ7fSkucmVkdWNlKHBsYXllclV0aWxzLmRldGVybWluZVZvdGVTaGFyZSxjYW5kaWRhdGVzMik7XHJcblxyXG5jb25zb2xlLmxvZyhlbGVjdGlvblRvdGFsczIpO1xyXG5cclxuZWxlY3Rpb25zLnB1c2goe1xyXG4gICAgaGlzdG9ncmFtOmFuYWx5dGljc1Rvb2xzLmhpc3RvZ3JhbUhhc2htYXBUb0FycmF5KHBvcHVsYXRpb24yLnJlZHVjZShhbmFseXRpY3NUb29scy5zb3J0Tm9kZXMsYW5hbHl0aWNzVG9vbHMuY3JlYXRlUmFuZ2UoMTAwKSkpLnNvcnQoKGEsYik9PiBhLmtleT5iLmtleSApLFxyXG4gICAgZWxlY3Rpb25Ub3RhbHM6W3tcclxuICAgICAgICBrZXk6XCJhZnRlciAxMCB3ZWVrcyBvZiBub2RlIGluZmx1ZW5jaW5nIG9uZSBhbm90aGVyXCIsXHJcbiAgICAgICAgdmFsdWVzOmVsZWN0aW9uVG90YWxzMlxyXG4gICAgfV1cclxufSk7XHJcblxyXG5cclxuY29uc29sZS5sb2coXCIlYyBhZnRlciAxMCB3ZWVrcyBvZiBjYW1wYWlnbmluZyBvbiB0aGUgdG9wIDUwJSByYW5kb20gbm9kZXMgXCIsICdiYWNrZ3JvdW5kOiAjMjIyOyBjb2xvcjogI2JhZGE1NScpO1xyXG5cclxubGV0IHRvcDI1ID0gcG9wdWxhdGlvbjMuc29ydCgoYSxiKT0+IGEuY29ubmVjdGlvbnMubGVuZ3RoID4gYi5jb25uZWN0aW9ucy5sZW5ndGgpLnNsaWNlKDAsTWF0aC5mbG9vcihwb3B1bGF0aW9uMy5sZW5ndGgvMikpO1xyXG5cclxuZm9yKGxldCBqID0gMDsgaiA8IDEwOyBqKyspe1xyXG4gICAgdG9wMjUuZm9yRWFjaChwbGF5ZXJVdGlscy5jYW1wYWlnbk9uTm9kZShcInNjdWJcIiwgLjIpKTtcclxuICAgIHBvcHVsYXRpb24zLmZvckVhY2goZ3JhcGhVdGlscy5pbmZsdWVuY2VOb2Rlcyk7XHJcbiAgICBwb3B1bGF0aW9uMy5mb3JFYWNoKGdyYXBoVXRpbHMuYXBwbHlJbmZsdWVuY2UpO1xyXG59XHJcblxyXG5sZXQgZWxlY3Rpb25Ub3RhbHMzID0gcG9wdWxhdGlvbjMubWFwKGVsZW1lbnQgPT4ge2VsZW1lbnQucG9wdWxhdGlvbiA9IDEwMDA7IHJldHVybiBlbGVtZW50O30pLnJlZHVjZShwbGF5ZXJVdGlscy5kZXRlcm1pbmVWb3RlU2hhcmUsY2FuZGlkYXRlczMpO1xyXG5cclxuY29uc29sZS5sb2coZWxlY3Rpb25Ub3RhbHMzKTtcclxuZWxlY3Rpb25zLnB1c2goe1xyXG4gICAgaGlzdG9ncmFtOmFuYWx5dGljc1Rvb2xzLmhpc3RvZ3JhbUhhc2htYXBUb0FycmF5KHBvcHVsYXRpb24zLnJlZHVjZShhbmFseXRpY3NUb29scy5zb3J0Tm9kZXMsYW5hbHl0aWNzVG9vbHMuY3JlYXRlUmFuZ2UoMTAwKSkpLnNvcnQoKGEsYik9PiBhLmtleT5iLmtleSApLFxyXG4gICAgZWxlY3Rpb25Ub3RhbHM6W3tcclxuICAgICAgICBrZXk6XCJhZnRlciAzIHdlZWtzIG9mIGNhbXBhaWduaW5nIG9uIHRoZSB0b3AgNTAlIHJhbmRvbSBub2Rlcy4gaGVyZSBpcyBhIGNoYW5nZSBJIG1hZGUhXCIsXHJcbiAgICAgICAgdmFsdWVzOmVsZWN0aW9uVG90YWxzM1xyXG4gICAgfV1cclxufSk7XHJcblxyXG5jb25zb2xlLmxvZyhcIiVjIGFmdGVyIDEwIHdlZWtzIG9mIGluZmx1ZW5jaW5nIHdoZW4gMjUlIG9mIHRoZSBub2RlcyBhcmUgc2N1YiBleHRyZWFtaXN0c1wiLCAnYmFja2dyb3VuZDogIzIyMjsgY29sb3I6ICNiYWRhNTUnKTtcclxuXHJcbmxldCBza3ViRXh0cmVhbWlzdHMgPSBwb3B1bGF0aW9uNS5zbGljZSgwLE1hdGguZmxvb3IocG9wdWxhdGlvbjUubGVuZ3RoIC8gMikpO1xyXG5za3ViRXh0cmVhbWlzdHMuZm9yRWFjaCgobm9kZSk9PntcclxuICAgIG5vZGUuaXNzdWVzLnNjdWIgPSAxO1xyXG59KTtcclxuXHJcbmZvcihsZXQgaiA9IDA7IGogPCAxMDsgaisrKXtcclxuICAgIHBvcHVsYXRpb241LmZvckVhY2goZ3JhcGhVdGlscy5pbmZsdWVuY2VOb2Rlcyk7XHJcbiAgICBwb3B1bGF0aW9uNS5mb3JFYWNoKGdyYXBoVXRpbHMuYXBwbHlJbmZsdWVuY2UpO1xyXG59XHJcblxyXG5sZXQgZWxlY3Rpb25Ub3RhbHM1ID0gcG9wdWxhdGlvbjUubWFwKGVsZW1lbnQgPT4ge2VsZW1lbnQucG9wdWxhdGlvbiA9IDEwMDA7IHJldHVybiBlbGVtZW50O30pLnJlZHVjZShwbGF5ZXJVdGlscy5kZXRlcm1pbmVWb3RlU2hhcmUsY2FuZGlkYXRlczUpO1xyXG5cclxuY29uc29sZS5sb2coZWxlY3Rpb25Ub3RhbHM1KTtcclxuZWxlY3Rpb25zLnB1c2goe1xyXG4gICAgaGlzdG9ncmFtOmFuYWx5dGljc1Rvb2xzLmhpc3RvZ3JhbUhhc2htYXBUb0FycmF5KHBvcHVsYXRpb241LnJlZHVjZShhbmFseXRpY3NUb29scy5zb3J0Tm9kZXMsYW5hbHl0aWNzVG9vbHMuY3JlYXRlUmFuZ2UoMTAwKSkpLnNvcnQoKGEsYik9PiBhLmtleT5iLmtleSApLFxyXG4gICAgZWxlY3Rpb25Ub3RhbHM6W3tcclxuICAgICAgICBrZXk6XCJhZnRlciAzIHdlZWtzIG9mIGluZmx1ZW5jaW5nIHdoZW4gNTAlIG9mIHRoZSBub2RlcyBhcmUgc2N1YiBleHRyZW1pc3RzLlwiLFxyXG4gICAgICAgIHZhbHVlczplbGVjdGlvblRvdGFsczVcclxuICAgIH1dXHJcbn0pO1xyXG5cclxuY29uc29sZS5sb2coXCIlYyBjYW1wYWlnbiBvbiBub2RlcyB0aGF0IGFscmVhZHkgYWdyZWUgd2l0aCBzY3ViXCIsICdiYWNrZ3JvdW5kOiAjMjIyOyBjb2xvcjogI2JhZGE1NScpO1xyXG5cclxubGV0IHNrdWJTdXBwb3J0ZXJzID0gcG9wdWxhdGlvbjYuZmlsdGVyKCBub2RlID0+IG5vZGUuaXNzdWVzLmdldCgnc2N1YicpID4gLjc1KTtcclxuY29uc29sZS5sb2coYHRoZXJlIGFyZSAke3NrdWJTdXBwb3J0ZXJzLmxlbmd0aH0gbm9kZSB0aGF0IGFscmVhZHkgc3VwcG9ydCBTa3ViYCk7XHJcblxyXG5mb3IobGV0IGogPSAwOyBqIDwgMTA7IGorKyl7XHJcbiAgICBza3ViU3VwcG9ydGVycy5mb3JFYWNoKHBsYXllclV0aWxzLmNhbXBhaWduT25Ob2RlKFwic2N1YlwiLCAuMikpO1xyXG4gICAgcG9wdWxhdGlvbjYuZm9yRWFjaChncmFwaFV0aWxzLmluZmx1ZW5jZU5vZGVzKTtcclxuICAgIHBvcHVsYXRpb242LmZvckVhY2goZ3JhcGhVdGlscy5hcHBseUluZmx1ZW5jZSk7XHJcbn1cclxuXHJcbmxldCBlbGVjdGlvblRvdGFsczYgPSBwb3B1bGF0aW9uNi5tYXAoZWxlbWVudCA9PiB7ZWxlbWVudC5wb3B1bGF0aW9uID0gMTAwMDsgcmV0dXJuIGVsZW1lbnQ7fSkucmVkdWNlKHBsYXllclV0aWxzLmRldGVybWluZVZvdGVTaGFyZSxjYW5kaWRhdGVzNik7XHJcblxyXG5jb25zb2xlLmxvZyhlbGVjdGlvblRvdGFsczYpO1xyXG5lbGVjdGlvbnMucHVzaCh7XHJcbiAgICBoaXN0b2dyYW06YW5hbHl0aWNzVG9vbHMuaGlzdG9ncmFtSGFzaG1hcFRvQXJyYXkocG9wdWxhdGlvbjYucmVkdWNlKGFuYWx5dGljc1Rvb2xzLnNvcnROb2RlcyxhbmFseXRpY3NUb29scy5jcmVhdGVSYW5nZSgxMDApKSkuc29ydCgoYSxiKT0+IGEua2V5PmIua2V5ICksXHJcbiAgICBlbGVjdGlvblRvdGFsczpbe1xyXG4gICAgICAgIGtleTpcIkNhbXBhaWduIG9uIG5vZGVzIHRoYXQgYWxyZWFkeSBhZ3JlZSB3aXRoIHNjdWJcIixcclxuICAgICAgICB2YWx1ZXM6ZWxlY3Rpb25Ub3RhbHM2XHJcbiAgICB9XVxyXG59KTtcclxuXHJcblxyXG5sZXQgaGlzdG9ncmFtID0gYW5hbHl0aWNzVG9vbHMuaGlzdG9ncmFtSGFzaG1hcFRvQXJyYXkocG9wdWxhdGlvbjMucmVkdWNlKGFuYWx5dGljc1Rvb2xzLnNvcnROb2RlcyxhbmFseXRpY3NUb29scy5jcmVhdGVSYW5nZSgxMDApKSkuc29ydCgoYSxiKT0+IGEua2V5PmIua2V5ICk7XHJcblxyXG5udi5hZGRHcmFwaChmdW5jdGlvbigpIHtcclxuICB2YXIgY2hhcnQgPSBudi5tb2RlbHMuZGlzY3JldGVCYXJDaGFydCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgLngoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC5uYW1lIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgLnkoZnVuY3Rpb24oZCkgeyByZXR1cm4gZC52b3RlcyB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgIC5zdGFnZ2VyTGFiZWxzKHRydWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgLnRvb2x0aXBzKGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgIC5zaG93VmFsdWVzKHRydWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgO1xyXG5cclxubGV0IGhpc3RvZ3JhbUNoYXJ0ID0gbnYubW9kZWxzLmhpc3RvcmljYWxCYXJDaGFydCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC54KGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQua2V5IH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC55KGZ1bmN0aW9uKGQpIHsgcmV0dXJuIGQudmFsdWUgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvcmNlWChbMCwxXSk7XHJcblxyXG5sZXQgZ3JhcGhzID0gZDMuc2VsZWN0KCcjZ3JhcGgtY29udGFpbmVyJylcclxuICAgICAgICAgICAgICAgLnNlbGVjdEFsbChcInN2Z1wiKVxyXG4gICAgICAgICAgICAgICAuZGF0YShlbGVjdGlvbnMpXHJcbiAgICAgICAgICAgICAgIC5lbnRlcigpXHJcbiAgICAgICAgICAgICAgIC5hcHBlbmQoXCJkaXZcIik7XHJcblxyXG5ncmFwaHMuYXBwZW5kKFwiSDFcIilcclxuICAgICAgLmRhdHVtKGZ1bmN0aW9uKGQpe1xyXG4gICAgICAgICAgcmV0dXJuIGQuZWxlY3Rpb25Ub3RhbHNcclxuICAgICAgfSlcclxuICAgICAgLnRleHQoZnVuY3Rpb24oZCl7XHJcbiAgICAgICAgICByZXR1cm4gZFswXS5rZXk7XHJcbiAgICAgIH0pO1xyXG5cclxuZ3JhcGhzLmFwcGVuZChcInN2Z1wiKVxyXG4gICAgICAuYXR0cihcImhlaWdodFwiLDIwMClcclxuICAgICAgLmRhdHVtKGZ1bmN0aW9uKGQpe1xyXG4gICAgICAgICAgICByZXR1cm4gZC5lbGVjdGlvblRvdGFsc1xyXG4gICAgICAgfSlcclxuICAgICAgLmNhbGwoY2hhcnQpO1xyXG5cclxuZ3JhcGhzLmFwcGVuZChcInN2Z1wiKVxyXG4gICAgICAuYXR0cihcImhlaWdodFwiLDIwMClcclxuICAgICAgLmRhdHVtKGZ1bmN0aW9uKGQpe1xyXG4gICAgICAgICAgcmV0dXJuW3tcclxuICAgICAgICAgICAgICBrZXk6ZC5lbGVjdGlvblRvdGFscy5rZXksXHJcbiAgICAgICAgICAgICAgdmFsdWVzOmQuaGlzdG9ncmFtXHJcbiAgICAgICAgICB9XVxyXG4gICAgICB9KVxyXG4gICAgICAuY2FsbChoaXN0b2dyYW1DaGFydCk7XHJcblxyXG4gIG52LnV0aWxzLndpbmRvd1Jlc2l6ZShjaGFydC51cGRhdGUpO1xyXG4gIG52LnV0aWxzLndpbmRvd1Jlc2l6ZShoaXN0b2dyYW1DaGFydC51cGRhdGUpO1xyXG5cclxuICByZXR1cm4gY2hhcnQ7XHJcbn0pO1xyXG4iXX0="}